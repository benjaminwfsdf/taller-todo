<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paso 5 ¬∑ Relleno de aceite</title>

  <style>
    :root{
      --brand:#900000;
      --ink:#e9ecef;
      --muted:#b9c0c7;
      --bg:#0b0b0c;
      --panel:#0f0f11;
      --card:#16181b;
      --card-border:#272a2f;
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      background:var(--bg);
      color:var(--ink);
    }
    .topbar{
      background:#000;color:#fff;text-align:center;
      padding:14px;border-bottom:4px solid var(--brand);
      font-weight:700;
    }
    .wrapper{max-width:900px;margin:24px auto;padding:0 12px;}
    .frame{border:3px solid var(--brand);border-radius:var(--radius);padding:20px;background:var(--panel);}
    .header{background:var(--brand);padding:18px;border-radius:14px;text-align:center;}
    .header h1{margin:0}

    .card{background:var(--card);border:1px solid var(--card-border);border-radius:14px;padding:16px;margin-top:20px;}

    label{display:block;margin-top:14px;font-weight:700}
    input{
      width:100%;margin-top:6px;padding:12px;border-radius:10px;
      background:#0c0c0e;color:#fff;border:1px solid #333;font-size:16px;
    }

    .hint{color:var(--muted);font-size:13px;margin-top:4px}
    .error{display:none;margin-top:12px;color:#ffb3b3}

    .btn{
      margin-top:20px;width:100%;min-height:48px;
      border-radius:12px;border:2px solid var(--brand);
      background:#0c0c0e;color:#fff;font-weight:800;cursor:pointer;
    }
    .btn:hover{background:var(--brand);}
  </style>
</head>

<body>

<div class="topbar">WWW.ELSE√ëORDELOSESCANER.CL</div>

<div class="wrapper">
  <div class="frame">
    <div class="header">
      <h1>üõ¢Ô∏è Paso 5 ¬∑ Relleno de aceite</h1>
    </div>

    <div class="card">

      <label>Tipo de aceite</label>
      <input id="tipo" placeholder="Ej: 5W-30">

      <label>Norma / especificaci√≥n</label>
      <input id="norma" placeholder="Ej: ACEA C3 / VW 507.00">
      <div class="hint">Usa la norma exacta del fabricante</div>

      <label>Cantidad cargada (litros)</label>
      <input id="cantidad" type="number" step="0.1" placeholder="Ej: 4.5">

      <div id="error" class="error">
        ‚ùå Debes completar tipo, norma y cantidad.
      </div>

      <button class="btn" onclick="guardarPaso()">Guardar y continuar</button>
    </div>
  </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxEYzoxATV0Cqn6zpug6PPTBRyO62XToCtEhk2F_Hgrq9v99f8zZr473PB6j_5v8e1qwA/exec";
const id = sessionStorage.getItem("aceite_id");

async function apiGet(p){
  const r = await fetch(API_URL + "?" + new URLSearchParams(p));
  return r.json();
}

async function guardarPaso(){
  if(!id){
    alert("Sesi√≥n perdida.");
    location.href="aceite_nuevo.html";
    return;
  }

  const tipo = document.getElementById("tipo").value.trim();
  const norma = document.getElementById("norma").value.trim();
  const cantidad = document.getElementById("cantidad").value.trim();

  if(!tipo || !norma || !cantidad){
    error.style.display="block";
    return;
  }

  await apiGet({
    action: "actualizar_servicio",
    id_servicio: id,
    aceite_tipo: tipo,
    aceite_norma: norma,
    aceite_cantidad_litros: cantidad
  });

  location.href="aceite_paso6.html";
}
</script>

</body>
</html>
