<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="manifest" href="manifest.json">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Taller">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <meta name="theme-color" content="#000000">
  <link rel="icon" type="image/png" href="icons/icon-192.png">

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("service-worker.js");
      });
    }
  </script>

  <title>Panel Principal</title>
  <style>
    :root{
      --brand:#900000;
      --brand-900:#700000;
      --ink:#e9ecef;
      --muted:#b9c0c7;
      --bg:#0b0b0c;
      --panel:#0f0f11;
      --card:#16181b;
      --card-border:#272a2f;
      --shadow:0 10px 28px rgba(0,0,0,.45);
      --shadow-hover:0 14px 40px rgba(0,0,0,.6);
      --radius:16px;
    }

    @media (prefers-reduced-motion: reduce){
      *{animation:none!important;transition:none!important}
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif;
      background: var(--bg);
      color: var(--ink);
      -webkit-font-smoothing: antialiased;
      line-height: 1.55;
    }

    /* === SPLASH (oculto por defecto; solo se muestra 1 vez por sesi√≥n) === */
    #splash{
      position: fixed;
      inset: 0;
      background: #000;
      display: none;               /* üëà oculto por defecto */
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity .6s ease;
      text-align:center;
      padding: 24px;
    }
    #splash img{
      width:160px;
      height:auto;
      margin-bottom:14px;
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
      filter: drop-shadow(0 8px 22px rgba(144,0,0,.35));
      animation: glow 1.6s ease-in-out infinite alternate;
    }
    #splash .brand{
      color:#fff;
      font-size: clamp(18px, 4vw, 26px);
      font-weight: 900;
      letter-spacing:.6px;
      line-height:1.15;
      margin: 2px 0 6px;
    }
    #splash .tagline{
      color:#c9ced6;
      font-size:14px;
      letter-spacing:.3px;
      opacity:.9;
    }
    #splash .bar{
      width: 180px; height: 4px;
      margin-top: 16px;
      background: #1d1d1f;
      border-radius: 999px;
      overflow: hidden;
      position: relative;
    }
    #splash .bar::after{
      content:"";
      position:absolute; inset:0;
      width:40%;
      background: linear-gradient(90deg, var(--brand-900), var(--brand));
      border-radius:999px;
      animation: slide 1.2s ease-in-out infinite;
    }
    @keyframes glow{
      from{ filter: drop-shadow(0 6px 16px rgba(144,0,0,.25)); }
      to  { filter: drop-shadow(0 12px 28px rgba(144,0,0,.45)); }
    }
    @keyframes slide{
      0%{transform: translateX(-60%);}
      50%{transform: translateX(40%);}
      100%{transform: translateX(160%);}
    }

    /* Barra superior */
    .topbar{
      background:#000;
      color:#fff;
      text-align:center;
      padding:14px 10px;
      font-weight:700;
      letter-spacing:.6px;
      border-bottom:4px solid var(--brand);
      box-shadow: 0 6px 16px rgba(0,0,0,.55);
    }

    .wrapper{
      max-width: 1100px;
      margin: 28px auto 44px;
      padding: 0 16px;
      opacity: 1;                 /* üëà visible por defecto */
      transition: opacity .6s ease;
    }
    .frame{
      border: 3px solid var(--brand);
      border-radius: var(--radius);
      padding: 20px;
      background: var(--panel);
      box-shadow: var(--shadow);
    }

    .header{
      margin: 10px;
      background: var(--brand);
      color:#fff;
      border-radius: 18px;
      padding: 20px 24px;
      text-align:center;
      box-shadow: 0 10px 22px rgba(179,0,0,.35);
    }
    .header h1{
      margin:0;
      font-size: clamp(20px, 3.2vw, 28px);
      letter-spacing:.5px;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(2,minmax(0,1fr));
      gap: 20px;
      padding: 12px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns: 1fr;}
    }

    .card{
      position: relative;
      background: var(--card);
      border:1px solid var(--card-border);
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      padding: 18px 18px 16px 18px;
      display:flex;
      gap:16px;
      align-items:flex-start;
      isolation:isolate;
      transition: box-shadow .2s ease, transform .2s ease, border-color .2s ease, background .2s ease;
    }
    .card::before{
      content:"";
      position:absolute;
      inset:0 auto 0 0;
      width:8px;
      border-radius: 14px 0 0 14px;
      background: var(--brand);
    }
    .card:hover{
      box-shadow: var(--shadow-hover);
      transform: translateY(-2px);
      border-color:#32363d;
      background:#191c20;
    }

    .icon{
      flex:0 0 44px;
      height:44px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      background: #0c0c0e;
      border:2px solid var(--brand);
      color:#fff;
      font-size:22px;
      margin-left: 6px;
      box-shadow: inset 0 0 12px rgba(179,0,0,.35);
    }

    .content{ flex:1 1 auto; min-width:0; }
    .title{
      margin:0 0 6px;
      font-size: clamp(16px, 2.2vw, 18px);
      font-weight:800;
      letter-spacing:.2px;
      color:#f5f7fa;
    }
    .desc{ margin:0; color: var(--muted); font-size:14.5px; }

    .actions{ display:flex; align-items:center; gap:10px; margin-left:auto; }
    .btn{
      appearance:none;
      border:0;
      border-radius: 12px;
      padding:10px 16px;
      font-weight:800;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .2s ease, background .2s ease, color .2s ease, border-color .2s ease;
      text-decoration:none;
      display:inline-block;
      color:#fff;
      background:#0c0c0e;
      border:2px solid var(--brand);
      box-shadow: 0 2px 0 rgba(0,0,0,.6), inset 0 0 12px rgba(179,0,0,.25);
    }
    .btn:hover{
      background: var(--brand);
      color:#fff;
      box-shadow: 0 4px 10px rgba(179,0,0,.35);
    }
    .btn:active{ transform: translateY(1px); }
    .btn:focus-visible{
      outline: 3px solid #fff2;
      outline-offset: 2px;
    }

    .footer{
      text-align:center;
      color:#8c96a3;
      font-size:12px;
      margin: 20px 0 32px;
    }
    .footer strong{ color:#cfd6de; }
  </style>
</head>
<body>
  <!-- SPLASH (se mostrar√° solo una vez por pesta√±a) -->
  <div id="splash" aria-live="polite" style="display:none">
    <img src="icons/icon-192.png" alt="Logo Taller">
    <div class="brand">El Se√±or de los Scanner</div>
    <div class="tagline">Cargando panel principal‚Ä¶</div>
    <div class="bar" aria-hidden="true"></div>
  </div>

  <div class="topbar">WWW.ELSE√ëORDELOSESCANER.CL</div>

  <div class="wrapper">
    <div class="frame">
      <div class="header">
        <h1>Panel Principal</h1>
      </div>

      <div class="grid" role="list">
        <!-- Gesti√≥n de Veh√≠culos -->
        <article class="card" role="listitem">
          <div class="icon">üöó</div>
          <div class="content">
            <h2 class="title">Gesti√≥n de Veh√≠culos</h2>
            <p class="desc">A√±adir, buscar y actualizar el estado de los autos del taller.</p>
          </div>
          <div class="actions">
            <a class="btn" href="gestion_autos.html">Abrir</a>
          </div>
        </article>

        <!-- Computadoras -->
        <article class="card" role="listitem">
          <div class="icon">üíª</div>
          <div class="content">
            <h2 class="title">Computadoras</h2>
            <p class="desc">Gesti√≥n de DPF OFF y registro/consulta de ECUs/BCMs.</p>
          </div>
          <div class="actions">
            <a class="btn" href="dpf_off.html">Abrir</a>
          </div>
        </article>

        <!-- Informes -->
        <article class="card" role="listitem">
          <div class="icon">üìÑ</div>
          <div class="content">
            <h2 class="title">Informes de Diagn√≥stico</h2>
            <p class="desc">Crear informes. Se abre en una pesta√±a nueva.</p>
          </div>
          <div class="actions">
            <a class="btn" href="https://taller-todo.vercel.app/informes.html" target="_blank">Abrir</a>
          </div>
        </article>

        <!-- Orden de llegada -->
        <article class="card" role="listitem">
          <div class="icon">üï∞Ô∏è</div>
          <div class="content">
            <h2 class="title">Orden de llegada</h2>
            <p class="desc">Gesti√≥n de turnos de clientes por orden de ingreso.</p>
          </div>
          <div class="actions">
            <a class="btn" href="clientes_turno.html">Abrir</a>
          </div>
        </article>

        <!-- Panel clientes -->
        <article class="card" role="listitem">
          <div class="icon">üßæ</div>
          <div class="content">
            <h2 class="title">Panel clientes (Orden)</h2>
            <p class="desc">Vista p√∫blica para que el cliente vea su turno.</p>
          </div>
          <div class="actions">
            <a class="btn" href="panel_clientes.html">Abrir</a>
          </div>
        </article>

         <article class="card" role="listitem">
          <div class="icon">üéüÔ∏è</div>
          <div class="content">
            <h2 class="title">Tarjeta virtual</h2>
            <p class="desc">Opciones para mostrar tu QR, copiar el link o escanear un QR.</p>
          </div>
          <div class="actions">
            <a class="btn" href="tarjeta-virtual.html">Abrir</a>
          </div>
        </article>


        <!-- Buscador -->
        <article class="card" role="listitem">
          <div class="icon">üèéÔ∏è</div>
          <div class="content">
            <h2 class="title">Buscador de c√≥digos</h2>
            <p class="desc">Consulta r√°pida de DTC y descripciones.</p>
          </div>
          <div class="actions">
            <a class="btn" href="buscador_averias.html" target="_blank">Abrir</a>
          </div>
        </article>

        <!-- Patentes Chile -->
        <article class="card" role="listitem">
          <div class="icon">üî¢</div>
          <div class="content">
            <h2 class="title">Patentes Chile</h2>
            <p class="desc">Consulta externa de informaci√≥n por patente.</p>
          </div>
          <div class="actions">
            <a class="btn" href="https://www.patentechile.com/" target="_blank" rel="noopener">Abrir</a>
          </div>
        </article>
      </div>
    </div>
    <div class="footer">¬© 2025 <strong>Benjamin Gonz√°lez</strong>. Todos los derechos reservados.</div>
  </div>

  <script>
    // ‚è±Ô∏è Tiempo m√≠nimo del splash (aj√∫stalo)
    const MIN_SPLASH_MS = 3000;

    // Tipo de navegaci√≥n (navigate / reload / back_forward)
    const nav = (performance.getEntriesByType && performance.getEntriesByType('navigation')[0]) || null;
    const isFirstNav = nav ? nav.type === 'navigate' : true;

    // ¬øYa se mostr√≥ en esta pesta√±a?
    const alreadyShown = sessionStorage.getItem('splashShownV1') === '1';

    function waitForLogo() {
      return new Promise(res => {
        const img = document.querySelector('#splash img');
        if (!img) return res();
        if (img.complete) return res();
        img.addEventListener('load', res, { once:true });
        img.addEventListener('error', res, { once:true });
      });
    }

    // pageshow cubre volver con bfcache (bot√≥n atr√°s)
    window.addEventListener('pageshow', async () => {
      const splash  = document.getElementById('splash');
      const wrapper = document.querySelector('.wrapper');

      // Si quieres que solo salga cuando est√° instalada como app:
      // const inStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
      // const shouldShow = isFirstNav && !alreadyShown && inStandalone;

      const shouldShow = isFirstNav && !alreadyShown; // üëà solo 1 vez por sesi√≥n/pesta√±a
      if (!shouldShow) {
        wrapper.style.opacity = '1';
        splash?.remove();
        return;
      }

      // Mostrar splash
      splash.style.display = 'flex';
      splash.style.opacity = '1';
      wrapper.style.opacity = '0';

      const start = performance.now();
      await waitForLogo();
      const elapsed = performance.now() - start;

      setTimeout(() => {
        splash.style.opacity = '0';
        wrapper.style.opacity = '1';
        setTimeout(() => splash.remove(), 600);
        sessionStorage.setItem('splashShownV1', '1');
      }, Math.max(0, MIN_SPLASH_MS - elapsed));
    });
  </script>
</body>
</html>
