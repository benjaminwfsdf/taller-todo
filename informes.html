<!DOCTYPE html>
<html lang="es">
  <script>
  const claveCorrecta = "informes@"; // Puedes cambiar esta clave

  const ingreso = prompt("üîê Ingresa la clave para acceder:");
  if (ingreso !== claveCorrecta) {
    alert("‚ùå Clave incorrecta. Acceso denegado.");
    window.location.href = "https://www.elsenordelosescaner.cl/"; // üîÅ Reemplaza con tu URL destino
  }
</script>


<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Informe de Diagn√≥stico</title>
  <style>
    @media print {
      @page {
        size: letter;
        margin-top: 6mm;
        margin-bottom: 6mm;
        margin-left: 20mm;
        margin-right: 20mm;
      }
      body {
        margin: 0;
        padding: 0;
        box-shadow: none;
        border: none;
      }
      #boton-imprimir {
        display: none;
      }
    }

    body {
      font-family: Arial, sans-serif;
      width: 21cm;
      min-height: 29.7cm;
      margin: auto;
      padding: 40px;
      background: white;
      border: 1px solid #000;
      box-sizing: border-box;
      font-size: 13px;
    }

    .titulo {
      width: 100%;
      background-color: #b30000;
      color: white;
      font-weight: bold;
      font-size: 24px;
      padding: 12px 0;
      text-align: center;
      box-sizing: border-box;
      margin: 0 0 10px 0;
    }

    .contacto-wrap {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .contacto {
      text-align: center;
      font-size: 14px;
      line-height: 1.4;
      flex: 1;
      font-weight: bold;
    }

    .contacto-wrap img {
      max-height: 170px;
      object-fit: contain;
    }

    .form-grid {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .form-grid td {
      padding: 6px;
      border: 1px solid #000;
      vertical-align: middle;
    }

    .form-grid label {
      font-weight: bold;
      margin-right: 6px;
      min-width: 60px;
      font-size: 14px;
    }

    .form-grid .inline {
      display: flex;
      align-items: center;
    }

    .form-grid input[type="text"] {
      width: 100%;
      padding: 2px 4px;
      box-sizing: border-box;
      border: 1px solid #000;
      font-size: 16px;
    }

    .seccion-titulo {
      font-weight: bold;
      margin-top: 20px;
      margin-bottom: 5px;
      text-transform: uppercase;
      background-color: #f0f0f0;
      padding: 6px;
      border: 1px solid #000;
    }

    .tabla-codigos {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      table-layout: fixed;
    }

    .tabla-codigos th, .tabla-codigos td {
      border: 1px solid #000;
      padding: 8px;
      vertical-align: top;
    }

    .tabla-codigos th {
      background-color: #d9d9d9;
      font-weight: bold;
      text-align: left;
    }

    .tabla-codigos textarea {
      width: 100%;
      height: 220px;
      border: none;
      resize: none;
      font-size: 16px;
      box-sizing: border-box;
      padding: 6px;
    }

    textarea {
      width: 100%;
      height: 100px;
      margin-top: 5px;
      padding: 6px;
      border: 1px solid #000;
      box-sizing: border-box;
      font-size: 16px;
    }

    .valor-final {
      margin-top: 20px;
      font-weight: bold;
      font-size: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .valor-final input {
      padding: 10px 16px;
      border: 2px solid #000;
      font-size: 20px;
      font-weight: bold;
      width: 180px;
      text-align: right;
    }

    .fecha-final {
      border: 1px solid black;
      padding: 6px 12px;
      font-size: 13px;
      color: black;
    }

    .nota-footer {
      font-size: 10px;
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>

<body onload="document.getElementById('fecha').innerText = new Date().toLocaleDateString('es-CL');">

  <div class="titulo">INFORME DE DIAGNOSTICO</div>

  <div class="contacto-wrap">
    <img src="img/logo-scanners.png" alt="logo scanners">
    <div class="contacto">
      WWW.ELSE√ëORDELOSESCANER.CL<br>
      DORSAL (ALTURA 6200) METRO NEPTUNO<br>
      CELULAR: +56976209564<br>
      (WALDO)<br><br>
      SCANNER ORIGINAL TODAS LAS MARCAS<br>
      LIMPIEZA INYECTORES ‚Äì SISTEMAS DPF - GASES LLAVES CON CHIP ‚Äì PROGRAMACION
    </div>
    <img src="img/qr-whatsapp.png" alt="QR whatsapp">
  </div>

  <table class="form-grid">


    <tr>
      <td><div class="inline"><label>MARCA:</label><input type="text" name="marca"style="text-transform: uppercase;"></div></td>
      <td><div class="inline"><label>MODELO:</label><input type="text" name="modelo"style="text-transform: uppercase;"></div></td>
    </tr>
    <tr>
      <td><div class="inline"><label>PATENTE:</label><input type="text" name="patente" style="text-transform: uppercase;"></div></td>
      <td><div class="inline"><label>A√ëO:</label><input type="text" name="ano"style="text-transform: uppercase;"></div></td>
    </tr>
    <tr>
      <td><div class="inline"><label>KM:</label><input type="text" name="km"style="text-transform: uppercase;"></div></td>
      <td><div class="inline"><label>MOTOR:</label><input type="text" name="motor"style="text-transform: uppercase;"></div></td>
    </tr>
  </table>

  <table class="tabla-codigos">
    <thead>
      <tr>
        <th style="width: 15%;">C√ìDIGOS</th>
        <th style="width: 70%;">DETALLE</th>
        <th style="width: 15%;">VALOR</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><textarea name="codigo_area"style="text-transform: uppercase;"></textarea>></textarea></td>
        <td><textarea name="detalle_area"></textarea></td>
        <td><textarea name="valor_area" style="font-weight:bold; font-size:16px;"></textarea></td>
      </tr>
    </tbody>
  </table>

  <div class="seccion-titulo">POSIBLES CAUSAS</div>
  <textarea name="causas"></textarea>

  <div class="seccion-titulo">RECOMENDACIONES</div>
  <textarea name="recomendaciones"></textarea>

  <div class="valor-final">
    <div class="fecha-final" id="fecha"></div>
    <div>
      $ <input type="text" name="valor_final">
    </div>
  </div>

  <div class="nota-footer">
    <strong>NOTA: COMPROBANTE VALIDO PARA SEGUNDO SCANNER (7 D√çAS)</strong>
  </div>

  <script>
  function guardarEnGoogleSheets() {
    const patente = document.querySelector('input[name="patente"]').value;
    const codigo = document.querySelector('textarea[name="codigo_area"]').value;
    const detalle = document.querySelector('textarea[name="detalle_area"]').value;

    // Guardar en Google Sheets
    fetch("https://script.google.com/macros/s/AKfycbzTDTkFKdwIqH8E_jDrOWx3chf42XasN-QI0WcCRav9gS9r7gZJ5tRIVVch1T6E1ukw/exec", {
      method: "POST",
      mode: "no-cors",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ patente, codigo, detalle })
    });

    // Imprimir
    window.onafterprint = () => {
  document.querySelectorAll('input[type="text"], textarea').forEach(el => el.value = '');
};

window.print();

  }
</script>


  <button id="boton-imprimir" onclick="guardarEnGoogleSheets()" style="position: fixed; bottom: 20px; right: 20px; padding: 10px 20px; font-size: 14px;">
    Imprimir y Guardar
  </button>

</body>
</html>
